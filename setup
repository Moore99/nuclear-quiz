using System.Data.SQLite;

// 1. Create a connection
string connectionString = "Data Source=mydatabase.db;Version=3;";
using (SQLiteConnection connection = new SQLiteConnection(connectionString))
{
    connection.Open();
    
    // 2. Create a command
    using (SQLiteCommand command = new SQLiteCommand("-- Users table (same pattern as CS50 Finance)
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    hash TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Categories (CANDU Systems, IAEA Safety Standards, Radiation Protection, etc.)
CREATE TABLE categories (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT,
    icon TEXT  -- for mobile UI later
);

-- Questions
CREATE TABLE questions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    category_id INTEGER REFERENCES categories(id),
    question_text TEXT NOT NULL,
    explanation TEXT,  -- shown after answering, key for learning
    difficulty INTEGER DEFAULT 1,  -- 1=basic, 2=intermediate, 3=advanced
    source TEXT,  -- e.g. "IAEA SSR-2/1", "CNSC REGDOC-2.1.2"
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Answer options (4 per question)
CREATE TABLE answers (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    question_id INTEGER REFERENCES questions(id),
    answer_text TEXT NOT NULL,
    is_correct INTEGER NOT NULL DEFAULT 0
);

-- User quiz results (needed for progress tracking later)
CREATE TABLE results (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER REFERENCES users(id),
    question_id INTEGER REFERENCES questions(id),
    answer_id INTEGER REFERENCES answers(id),
    is_correct INTEGER NOT NULL,
    answered_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);", connection))
    {
        // 3. Execute the command
        using (SQLiteReader reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                Console.WriteLine(reader["ColumnName"]);
            }
        }
    }
}